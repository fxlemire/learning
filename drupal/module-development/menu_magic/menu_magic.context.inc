<?php
function menu_magic_node_context($node) {
  $text = _menu_magicify($node->body['und'][0]['value']);
  $output = array(
    '#type' => 'markup',
    '#markup' => $text
  );

  return $output;
}

/**
 * Helper function.
 */
function _menu_magicify($text) {
  $substitutions = array(
    ' ' => ' ',
    '!' => 'Â¡',
    '"' => ',,',
    '#' => '#',
    '$' => '$',
    '%' => '%',
    '&' => 'â…‹',
    "'" => ',',
    '(' => ')',
    ')' => '(',
    '*' => '*',
    '+' => '+',
    ',' => "'",
    '-' => '-',
    '.' => 'Ë™',
    '/' => '/',
    '0' => '0',
    '1' => 'Æ–',
    '2' => 'á„…',
    '3' => 'Æ',
    '4' => 'ã„£',
    '5' => 'Ï›',
    '6' => '9',
    '7' => 'ã„¥',
    '8' => '8',
    '9' => '6',
    ':' => ':',
    ';' => '',
    '<' => '>',
    '=' => '=',
    '>' => '<',
    '?' => 'Â¿',
    '@' => '@',
    'A' => 'âˆ€',
    'B' => 'ð’',
    'C' => 'Æ†',
    'D' => 'â—–',
    'E' => 'ÆŽ',
    'F' => 'â„²',
    'G' => '×¤',
    'H' => 'H',
    'I' => 'I',
    'J' => 'Å¿',
    'K' => 'Êž',
    'L' => 'Ë¥',
    'M' => 'W',
    'N' => 'N',
    'O' => 'O',
    'P' => 'Ô€',
    'Q' => 'ÎŒ',
    'R' => 'á´š',
    'S' => 'S',
    'T' => 'â”´',
    'U' => 'âˆ©',
    'V' => 'Î›',
    'W' => 'M',
    'X' => 'X',
    'Y' => 'â…„',
    'Z' => 'Z',
    '[' => ']',
    '\\' => '\\',
    ']' => '[',
    '^' => 'â€¿',
    '_' => "â€¾",
    '`' => " Ì–",
    'a' => 'É',
    'b' => 'q',
    'c' => 'É”',
    'd' => 'p',
    'e' => 'Ç',
    'f' => 'ÉŸ',
    'g' => 'Æƒ',
    'h' => 'É¥',
    'i' => 'á´‰',
    'j' => 'É¾',
    'k' => 'Êž',
    'l' => 'l',
    'm' => 'É¯',
    'n' => 'u',
    'o' => 'o',
    'p' => 'd',
    'q' => 'b',
    'r' => 'É¹',
    's' => 's',
    't' => 'Ê‡',
    'u' => 'n',
    'v' => 'ÊŒ',
    'w' => 'Ê',
    'x' => 'x',
    'y' => 'ÊŽ',
    'z' => 'z',
    '{' => '}',
    '|' => '|',
    '}' => '{',
    '~' => '~',
  );

  $find = array_keys($substitutions);
  $replace = array_values($substitutions);

  return str_replace($find, $replace, $text);
}